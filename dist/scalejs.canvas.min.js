define("scalejs.canvas/utils",[],function(){"use strict";var a={left:function(a){return 0},top:function(a){return 0},center:function(a){return-a/2},right:function(a){return-a},bottom:function(a){return-a}},b={left:function(a,b){return a},top:function(a,b){return a},center:function(a,b){return a-b/2},right:function(a,b){return a-b},bottom:function(a,b){return a-b}};return{getOffset:a,applyOffset:b}}),define("scalejs.canvas/group",["./utils"],function(a){"use strict";return function(b){function c(a){this.type="group",this.className="group",this.parent=a.parent||b,this.id=a.id||a.parent.children.length,this.data=a.data||{},this.fontFamily=a.fontFamily||"",this.fontSize=a.fontSize||0,this.originX=a.originX||"left",this.originY=a.originY||"top",this.left=a.left||0,this.top=a.top||0,this.width=a.width||0,this.height=a.height||0,this.angle=a.angle||0,this.scaleX=a.scaleX||1,this.scaleY=a.scaleY||1,this.backFill=a.backFill||"",this.opacity=a.opacity||1,this.offset={left:0,top:0},this.pos={left:0,top:0},this.extents={left:0,top:0,right:0,bottom:0},this.children=[]}return c.prototype.getExtents=function(){return this.extents},c.prototype.calcBounds=function(){var c,d;this.fontFamily&&this.fontSize?(this.font=this.fontSize+"px "+this.fontFamily,this.font!==b.curFont&&(c=b.curFont,d=b.curFontSize,b.context.save(),b.context.font=this.font,b.curFont=this.font,b.curFontSize=this.fontSize)):this.font=void 0;for(var e=0;e<this.children.length;e++)this.children[e].calcBounds();c&&(b.curFont=c,b.curFontSize=d,b.context.restore()),this.offset.left=a.getOffset[this.originX](this.width),this.offset.top=a.getOffset[this.originY](this.height),this.pos.left=this.left+this.offset.left,this.pos.top=this.top+this.offset.top,this.radianAngle=this.angle*Math.PI/180},c.prototype.render=function(){if(!(this.opacity<=0)){if(b.context.save(),this.opacity<1&&(b.context.globalAlpha*=this.opacity),b.context.translate(this.pos.left,this.pos.top),b.context.scale(this.scaleX,this.scaleY),b.context.rotate(this.radianAngle),this.backFill&&this.width>0&&this.height>0&&(b.context.fillStyle=this.backFill,b.context.fillRect(0,0,this.width,this.height)),this.font&&this.font!==b.curFont){var a=b.curFont,c=b.curFontSize;b.context.font=this.font,b.curFont=this.font,b.curFontSize=this.fontSize;for(var d=0;d<this.children.length;d++)this.children[d].render();b.curFont=a,b.curFontSize=c}else for(var d=0;d<this.children.length;d++)this.children[d].render();b.context.restore()}},c.prototype.isPointIn=function(a,b,c){a-=this.pos.left,b-=this.pos.top,a/=this.scaleX,b/=this.scaleY;var d=Math.sin(-this.radianAngle),e=Math.cos(-this.radianAngle),f=a;if(a=a*e-b*d,b=f*d+b*e,this.backFill)return a>=0&&b>=0&&a<=this.width&&b<=this.height;for(var g=0;g<this.children.length;g++)if(this.children[g].isPointIn(a,b,c))return!0;return!1},c.prototype.touchEventHandler=function(a,b,c){a-=this.pos.left,b-=this.pos.top,a/=this.scaleX,b/=this.scaleY;var d=Math.sin(-this.radianAngle),e=Math.cos(-this.radianAngle),f=a;a=a*e-b*d,b=f*d+b*e;for(var g=0;g<this.children.length;g++)this.children[g].isPointIn(a,b,c)&&this.children[g].touchEventHandler(a,b,c);this[c.name]&&this[c.name](this.data.data)},c.prototype.remove=function(){this.parent.children.splice(this.parent.children.indexOf(this),1)},c}}),define("scalejs.canvas/rect",["./utils"],function(a){"use strict";return function(b){function c(a){this.type="obj",this.className="rect",this.parent=a.parent||b,this.id=a.id||a.parent.children.length,this.data=a.data||{},this.originX=a.originX||"left",this.originY=a.originY||"top",this.left=a.left||0,this.top=a.top||0,this.width=a.width||0,this.height=a.height||0,this.fill=a.fill||"#000",this.offset={left:0,top:0},this.pos={left:0,top:0},this.extents={left:0,top:0,right:0,bottom:0}}return c.prototype.getExtents=function(){return this.extents},c.prototype.calcBounds=function(){this.offset.left=a.getOffset[this.originX](this.width),this.offset.top=a.getOffset[this.originY](this.height),this.pos.left=this.left+this.offset.left,this.pos.top=this.top+this.offset.top,this.extents.left=this.pos.left,this.extents.top=this.pos.top,this.extents.right=this.pos.left+this.width,this.extents.bottom=this.pos.top+this.height},c.prototype.render=function(){this.width>0&&this.height>0&&(b.context.fillStyle=this.fill,b.context.fillRect(this.pos.left,this.pos.top,this.width,this.height))},c.prototype.isPointIn=function(a,b,c){return a>=this.extents.left&&b>=this.extents.top&&a<=this.extents.right&&b<=this.extents.bottom},c.prototype.touchEventHandler=function(a,b,c){this[c.name]&&this[c.name](this.data.data)},c.prototype.remove=function(){this.parent.children.splice(this.parent.children.indexOf(this),1)},c}}),define("scalejs.canvas/text",["./utils"],function(a){"use strict";return function(b){function c(a){this.type="obj",this.className="text",this.parent=a.parent||b,this.id=a.id||a.parent.children.length,this.data=a.data||{},this.fontFamily=a.fontFamily||"",this.fontSize=a.fontSize||0,this.text=a.text||"",this.originX=a.originX||"left",this.originY=a.originY||"top",this.left=a.left||0,this.top=a.top||0,this.width=a.width||0,this.height=a.height||0,this.angle=a.angle||0,this.fill=a.fill||"#000",this.offset={left:0,top:0},this.pos={left:0,top:0},this.extents={left:0,top:0,right:0,bottom:0}}return c.prototype.setText=function(a){this.fontFamily&&this.fontSize?(this.font=this.fontSize+"px "+this.fontFamily,this.height=this.fontSize):(this.font=void 0,this.height=b.curFontSize),!this.font||this.font===this.calcFont&&this.calcText===this.text?this.font||b.curFont===this.calcFont&&this.calcText===this.text||(this.text=a,this.width=b.context.measureText(a||"").width,this.calcText=this.text,this.calcFont=b.curFont):(b.context.save(),b.context.font=this.font,this.text=a,this.width=b.context.measureText(a||"").width,b.context.restore(),this.calcText=this.text,this.calcFont=this.font)},c.prototype.getExtents=function(){return this.extents},c.prototype.calcBounds=function(){this.setText(this.text),this.offset.left=a.getOffset[this.originX](this.width),this.offset.top=a.getOffset[this.originY](this.height)+this.height,this.pos.left=this.left+this.offset.left,this.pos.top=this.top+this.offset.top,this.extents.left=this.pos.left,this.extents.right=this.pos.left,this.extents.top=this.pos.top+this.width,this.extents.bottom=this.pos.top+this.height},c.prototype.render=function(){this.opacity>0&&this.text.length>0&&(b.context.save(),this.font&&this.font!==b.curFont&&(b.context.font=this.font),this.fill&&(b.context.fillStyle=this.fill),this.opacity<1&&(b.context.globalAlpha*=this.opacity),b.context.translate(this.left,this.top),this.angle&&b.context.rotate(this.angle*Math.PI/180),b.context.fillText(this.text,this.offset.left,this.offset.top),b.context.restore())},c.prototype.isPointIn=function(a,b,c){return a>=this.extents.left&&b>=this.extents.top&&a<=this.extents.right&&b<=this.extents.bottom},c.prototype.touchEventHandler=function(a,b,c){this[c.name]&&this[c.name](this.data.data)},c.prototype.remove=function(){this.parent.children.splice(this.parent.children.indexOf(this),1)},c}}),define("scalejs.canvas/arc",["./utils"],function(a){"use strict";var b=.5*Math.PI;return function(a){function c(b){this.type="obj",this.className="arc",this.parent=b.parent||a,this.id=b.id||b.parent.children.length,this.data=b.data||{},this.originX=b.originX||"center",this.originY=b.originY||"center",this.left=b.left||0,this.top=b.top||0,this.width=b.width||0,this.height=b.height||0,this.radius=0,this.innerRadius=b.innerRadius||0,this.outerRadius=b.outerRadius||0,this.thickness=0,this.startAngle=b.startAngle||0,this.endAngle=b.endAngle||0,this.fill=b.fill||"#000",this.opacity=b.opacity||1,this.offset={left:0,top:0},this.pos={left:0,top:0},this.extents={left:0,top:0,right:0,bottom:0}}return c.prototype.getExtents=function(){return this.extents},c.prototype.calcBounds=function(){this.width=this.height=2*this.outerRadius,this.offset.left=this.left,this.offset.top=this.top,this.extents.left=this.offset.left-this.outerRadius,this.extents.right=this.offset.left+this.outerRadius,this.extents.top=this.offset.top-this.outerRadius,this.extents.bottom=this.offset.top+this.outerRadius,this.thickness=this.outerRadius-this.innerRadius,this.radius=this.thickness/2+this.innerRadius},c.prototype.render=function(){if(this.opacity>0&&0!==this.thickness&&this.endAngle!==this.startAngle&&(a.context.beginPath(),this.fill&&(a.context.strokeStyle=this.fill),this.opacity<1&&(a.context.globalAlpha*=this.opacity),a.context.lineWidth=this.thickness,a.context.arc(this.offset.left,this.offset.top,this.radius,this.startAngle-b,this.endAngle-b),a.context.stroke(),this.highlight)){a.context.strokeStyle="#FFFFFF",a.context.lineWidth=6;var c=a.context.globalAlpha;a.context.globalAlpha=this.highlight,0!==this.startAngle&&this.startAngle!==2*Math.PI?(a.context.beginPath(),a.context.arc(this.offset.left,this.offset.top,this.outerRadius-3*(1-.2*this.highlight),this.startAngle-b,this.endAngle-b,!1),a.context.arc(this.offset.left,this.offset.top,this.innerRadius+3,this.endAngle-b,this.startAngle-b,!0),a.context.arc(this.offset.left,this.offset.top,this.outerRadius-3*(1-.2*this.highlight),this.startAngle-b,this.endAngle-b,!1),a.context.stroke()):(a.context.beginPath(),a.context.arc(this.offset.left,this.offset.top,this.outerRadius-3,this.startAngle-b,this.endAngle-b,!1),a.context.stroke(),0!==this.innerRadius&&(a.context.beginPath(),a.context.arc(this.offset.left,this.offset.top,this.innerRadius+3,this.endAngle-b,this.startAngle-b,!0),a.context.stroke())),a.context.globalAlpha=c}},c.prototype.isPointIn=function(a,c,d){var e=(a-this.offset.left)*(a-this.offset.left)+(c-this.offset.top)*(c-this.offset.top),f=Math.atan2(c-this.offset.top,a-this.offset.left)+b;return 0>f&&(f+=2*Math.PI),e<=this.outerRadius*this.outerRadius&&e>=this.innerRadius*this.innerRadius&&f>=this.startAngle&&f<=this.endAngle},c.prototype.touchEventHandler=function(a,b,c){this[c.name]&&this[c.name](this.data.data)},c.prototype.remove=function(){this.parent.children.splice(this.parent.children.indexOf(this),1)},c}}),define("scalejs.canvas/selector",["./group","./rect","./text","./arc"],function(a,b,c,d){"use strict";var e=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(a){return window.setTimeout(a,1e3/60),!0};return function(f){function g(a){this.isTransition=a.isTransition||!1,this.durationTime=a.durationTime||250,this.easeFunc=a.easeFunc||function(a){return a},this.endFunc=void 0,this.object=a.object||f,this.objects=a.objects||[],this.enterObjects=a.enterObjects||[],this.updateObjects=a.updateObjects||[],this.exitObjects=a.exitObjects||[]}var h,i={group:a(f),rect:b(f),text:c(f),arc:d(f)};return g.prototype.select=function(a){var b,c,d,e=[];if("string"==typeof a){for(c=0;c<this.objects.length;c++)if(b=this.objects[c],void 0!==b.children&&b.children.length>0)for(d=0;d<b.children.length;d++)if(b.children[d].className===a){e.push(b.children[d]);break}return new g({isTransition:this.isTransition,durationTime:this.durationTime,easeFunc:this.easeFunc,object:e.length>0?e[0].parent:this.objects.length>0?this.objects[0]:this.object,objects:e})}return new g({isTransition:this.isTransition,durationTime:this.durationTime,easeFunc:this.easeFunc,object:a,objects:[a]})},g.prototype.selectAll=function(a){var b,c,d,e=[];for(c=0;c<this.objects.length;c++)if(b=this.objects[c],void 0!==b.children&&b.children.length>0)for(d=0;d<b.children.length;d++)b.children[d].className===a&&e.push(b.children[d]);return new g({isTransition:this.isTransition,durationTime:this.durationTime,easeFunc:this.easeFunc,object:e.length>0?e[0].parent:this.objects.length>0?this.objects[0]:this.object,objects:e})},g.prototype.filter=function(a){for(var b=[],c=0;c<this.objects.length;c++)a.call(this.objects[c],this.objects[c].data.data)&&b.push(this.objects[c]);return new g({isTransition:this.isTransition,durationTime:this.durationTime,easeFunc:this.easeFunc,object:b.length>0?b[0].parent:this.objects.length>0?this.objects[0]:this.object,objects:b})},g.prototype.data=function(a,b){for(var c={},d=0;d<a.length;d++){var e=b(a[d]);a[d]={id:e,data:a[d]},c[e]=a[d]}this.exitObjects=[],this.updateObjects=this.objects,this.objects=[];for(var d=0;d<this.updateObjects.length;d++)c[this.updateObjects[d].data.id]?(this.updateObjects[d].data.data=c[this.updateObjects[d].data.id].data,c[this.updateObjects[d].data.id]=void 0,this.objects.push(this.updateObjects[d])):(this.exitObjects.push(this.updateObjects[d]),this.updateObjects.splice(d,1),d--);for(var d=0;d<a.length;d++)c[a[d].id]||(a.splice(d,1),d--);return this.enterObjects=a,this},g.prototype.enter=function(){return{parentSelector:this,append:function(a,b){return b=b||{},new g({isTransition:this.parentSelector.isTransition,durationTime:this.parentSelector.durationTime,easeFunc:this.parentSelector.easeFunc,objects:this.parentSelector.enterObjects.map(function(c){b.parent=this.parentSelector.object,b.data=c;var d=new i[a](b);return this.parentSelector.object.children.push(d),d},this)})}}},g.prototype.update=function(){var a=new g(this);return a.objects=this.updateObjects,a},g.prototype.exit=function(){var a=new g(this);return a.objects=this.exitObjects,a},g.prototype.on=function(a,b){return a="on"+a,this.objects.forEach(function(c){c[a]=b}),this},g.prototype.append=function(a,b){b=b||{};var c=new g(this);return c.objects=this.objects.map(function(c){b.parent=c,b.data=c.data;var d=new i[a](b);return c.children.push(d),d}),c},g.prototype.remove=function(){return this.objects.forEach(function(a){a.parent.children.splice(a.parent.children.indexOf(a),1)}),this.objects=[],this},g.prototype.attr=function(a,b){return this.objects.forEach(function(c){b instanceof Function&&(b=b.call(c,c.data.data)),c["set"+a]instanceof Function?c["set"+a](b):c[a]=b}),this},g.prototype.sort=function(a){return this.objects.sort(function(b,c){return a(b.data.data,c.data.data)}),this},g.prototype.order=function(){return this.objects.forEach(function(a){a.parent.children.splice(a.parent.children.indexOf(a),1),a.parent.children.push(a)}),this},g.prototype.each=function(a,b){return void 0===b||"start"===b?this.objects.forEach(function(b){a.call(b,b.data.data)}):"end"===b&&this.objects.forEach(function(b){b.tweenEndFunc=a}),this},g.prototype.transition=function(){var a=new g(this);return a.isTransition=!0,a.objects.forEach(function(a){a.tweenEndFunc=void 0}),a},g.prototype.duration=function(a){return this.durationTime=a,this},g.prototype.ease=function(a){return this.easeFunc=a,this},g.prototype.tween=function(a,b){var c,d,g=(new Date).getTime(),h=g+this.durationTime;for(d=0;d<this.objects.length;d++)c=this.objects[d],c.animationIndex>=0||(c.animationIndex=f.animations.length,f.animations[c.animationIndex]=c),c.tweenFunc=b.call(c,c.data.data),c.easeFunc=this.easeFunc,c.timeStart=g,c.timeEnd=h,c.duration=this.durationTime;return void 0===f.requestFrameID&&f.animations.length>0&&(f.requestFrameID=e(function(){f.onAnimationFrame()})),this},g.prototype.startRender=function(){},g.prototype.pumpRender=function(){return f.pumpRender(),h},h=new g({objects:[f]}),h[0]=[f.element],h}}),define("scalejs.canvas/canvas",["hammer","./selector"],function(a,b){"use strict";function c(a){this.type="canvas",this.className="canvas",this.element=a,this.context=a.getContext("2d"),this.parent=this,this.width=a.width,this.height=a.height,this.children=[],this.animations=[],this.requestFrameID=void 0,this.curFont="",this.curFontSize=0}function d(d){function e(a){if(a.gesture&&(a.gesture.preventDefault(),1===a.gesture.touches.length)){var b,c=a.gesture.touches[0],d=c.target.style.display;c.target.style.display="",b=c.target.getBoundingClientRect(),c.target.style.display=d,a.offsetX=c.pageX-b.left,a.offsetY=c.pageY-b.top,a.name="on"+a.type;for(var e=0;e<f.children.length;e++)f.children[e].isPointIn(a.offsetX,a.offsetY,a)&&f.children[e].touchEventHandler(a.offsetX,a.offsetY,a)}}var f=new c(d),g=a(f.element,{prevent_default:!0,drag_min_distance:10,hold_threshold:10});return g.on("hold tap doubletap touch release",e),b(f)}var e=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(a){return window.setTimeout(a,1e3/60),!0};return c.prototype.setwidth=function(a){this.element.width=a,this.width=a},c.prototype.setheight=function(a){this.element.height=a,this.height=a},c.prototype.onAnimationFrame=function(){if(this.animations.length<=0||this.width<=0||this.height<=0)return void(this.requestFrameID=void 0);var a=this;this.requestFrameID=e(function(){a.onAnimationFrame()});for(var b,c=(new Date).getTime(),d=0;d<this.animations.length;d++){b=this.animations[d];var f=Math.min((c-b.timeStart)/b.duration,1);b.tweenFunc(b.easeFunc(f)),c>=b.timeEnd?(b.animationIndex=void 0,b.tweenEndFunc&&b.tweenEndFunc(b.data.data),this.animations.splice(d,1),d--):b.animationIndex=d}this.render()},c.prototype.render=c.prototype.pumpRender=function(){if(!(this.width<=0||this.height<=0)){this.context.setTransform(1,0,0,1,0,0),this.context.font="40px Times New Roman",this.curFont="40px Times New Roman",this.curFontSize=40;for(var a=0;a<this.children.length;a++)this.children[a].calcBounds();this.context.clearRect(0,0,this.element.width,this.element.height);for(var a=0;a<this.children.length;a++)this.children[a].render()}},c.prototype.startRender=function(){console.warn("canvas.startRender is deprecated!")},{select:d}}),define("scalejs.canvas",["scalejs!core","./scalejs.canvas/canvas"],function(a,b){"use strict";return a.registerExtension({canvas:b}),b});